# SMTMAX Production Backend

Backend API –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ–º –û–û–û ¬´–°–ú–¢–ú–ê–ö–° –ü–†–û–î–ê–ö–®–ù¬ª.

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Runtime:** Node.js 18+
- **Framework:** NestJS 10+
- **ORM:** Prisma 5+
- **Database:** PostgreSQL 14+
- **Authentication:** JWT (passport-jwt)
- **Documentation:** Swagger/OpenAPI

## üìã –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ú–æ–¥—É–ª–∏ —Å–∏—Å—Ç–µ–º—ã

1. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**
   - JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (Access + Refresh tokens)
   - –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å –¥–æ—Å—Ç—É–ø–∞ (RBAC)
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ä–æ–ª—è–º–∏

2. **–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –ø–∞—è–ª—å–Ω–æ–π –ø–∞—Å—Ç—ã**
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç—É—Ä–∞–º–∏ (—Å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞–º–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏)
   - –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã
   - –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–∞—Ä—Ç–∏–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–ø–∏—Å–∞–Ω–∏–µ–º –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
   - –ö–æ–Ω—Ç—Ä–æ–ª—å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

3. **–°–∫–ª–∞–¥—Å–∫–æ–π —É—á–µ—Ç**
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏
   - –ü—Ä–∏—Ö–æ–¥ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –Ω–∞ —Å–∫–ª–∞–¥
   - –ò—Å—Ç–æ—Ä–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
   - –ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–æ–π
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–∏–∑–∫–∏—Ö –æ—Å—Ç–∞—Ç–∫–∞—Ö

4. **–ü—É—Å–∫–æ–Ω–∞–ª–∞–¥–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã**
   - –°–µ—Ä–≤–∏—Å–Ω—ã–µ –∑–∞–∫–∞–∑—ã
   - –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏–Ω–∂–µ–Ω–µ—Ä–æ–≤
   - –ñ—É—Ä–Ω–∞–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

5. **–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—ã**
   - –ó–∞–∫–∞–∑—á–∏–∫–∏ –∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏

6. **–û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞**
   - –û—Ç—á–µ—Ç—ã –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É (–ø–ª–∞–Ω/—Ñ–∞–∫—Ç, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
   - –û—Ç—á–µ—Ç—ã –ø–æ —Å–∫–ª–∞–¥—É (–æ—Å—Ç–∞—Ç–∫–∏, –¥–≤–∏–∂–µ–Ω–∏–µ)
   - –û—Ç—á–µ—Ç—ã –ø–æ —Å–µ—Ä–≤–∏—Å–Ω—ã–º —Ä–∞–±–æ—Ç–∞–º (–∑–∞–≥—Ä—É–∑–∫–∞ –∏–Ω–∂–µ–Ω–µ—Ä–æ–≤)
   - –î–∞—à–±–æ—Ä–¥ –¥–ª—è —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js >= 18
- PostgreSQL >= 14
- npm –∏–ª–∏ yarn

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

\`\`\`bash
git clone <repository-url>
cd smtmax-backend
\`\`\`

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

\`\`\`bash
npm install
\`\`\`

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:

\`\`\`bash
cp .env.example .env
\`\`\`

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env`:

\`\`\`env
NODE_ENV=development
PORT=3000
API_PREFIX=api/v1

DATABASE_URL="postgresql://smtmax:password123@localhost:5432/smtmax_db?schema=public"

JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_ACCESS_EXPIRATION=15m
JWT_REFRESH_EXPIRATION=7d

CORS_ORIGIN=http://localhost:3001
LOG_LEVEL=debug
\`\`\`

### 4. –ó–∞–ø—É—Å–∫ PostgreSQL (Docker)

\`\`\`bash
docker-compose up -d
\`\`\`

### 5. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

\`\`\`bash
npx prisma migrate dev
\`\`\`

### 6. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

\`\`\`bash
npx prisma db seed
\`\`\`

–ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:
- Email: `admin@smtmax.com`
- Password: `admin123`

### 7. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**Development:**
\`\`\`bash
npm run start:dev
\`\`\`

**Production:**
\`\`\`bash
npm run build
npm run start:prod
\`\`\`

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:

\`\`\`
http://localhost:3000/api-docs
\`\`\`

## üîê –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

| –†–æ–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ | –î–æ—Å—Ç—É–ø |
|------|----------|--------|
| ADMIN | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–∏—Å—Ç–µ–º—ã | –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø |
| PRODUCTION_MANAGER | –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ | –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ, –æ—Ç—á–µ—Ç—ã |
| WAREHOUSE_MANAGER | –ö–ª–∞–¥–æ–≤—â–∏–∫/–°–Ω–∞–±–∂–µ–Ω–µ—Ü | –°–∫–ª–∞–¥, –º–∞—Ç–µ—Ä–∏–∞–ª—ã |
| TECHNOLOGIST | –¢–µ—Ö–Ω–æ–ª–æ–≥ | –†–µ—Ü–µ–ø—Ç—É—Ä—ã |
| SERVICE_MANAGER | –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ —Å–µ—Ä–≤–∏—Å—É | –°–µ—Ä–≤–∏—Å–Ω—ã–µ –∑–∞–∫–∞–∑—ã |
| ENGINEER | –ò–Ω–∂–µ–Ω–µ—Ä-–Ω–∞–ª–∞–¥—á–∏–∫ | –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç |
| ACCOUNTANT | –ë—É—Ö–≥–∞–ª—Ç–µ—Ä/–§–∏–Ω–∞–Ω—Å–∏—Å—Ç | –û—Ç—á–µ—Ç—ã |

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

\`\`\`bash
# Unit —Ç–µ—Å—Ç—ã
npm run test

# E2E —Ç–µ—Å—Ç—ã
npm run test:e2e

# –ü–æ–∫—Ä—ã—Ç–∏–µ
npm run test:cov
\`\`\`

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

\`\`\`
smtmax-backend/
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îú‚îÄ‚îÄ migrations/          # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma        # –°—Ö–µ–º–∞ –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ seed.ts              # –ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ common/              # –û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ decorators/      # –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ filters/         # Exception filters
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ guards/          # Auth guards
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ interceptors/    # Interceptors
‚îÇ   ‚îú‚îÄ‚îÄ config/              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ modules/             # –ú–æ–¥—É–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/            # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users/           # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ roles/           # –†–æ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ materials/       # –ú–∞—Ç–µ—Ä–∏–∞–ª—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ recipes/         # –†–µ—Ü–µ–ø—Ç—É—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ production/      # –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory/       # –°–∫–ª–∞–¥
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ contractors/     # –ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ service/         # –°–µ—Ä–≤–∏—Å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reports/         # –û—Ç—á–µ—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ health/          # Health check
‚îÇ   ‚îú‚îÄ‚îÄ prisma/              # Prisma —Å–µ—Ä–≤–∏—Å
‚îÇ   ‚îú‚îÄ‚îÄ app.module.ts
‚îÇ   ‚îî‚îÄ‚îÄ main.ts
‚îú‚îÄ‚îÄ .env                     # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ docker-compose.yml       # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ README.md
\`\`\`

## üîß –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

\`\`\`bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client
npx prisma generate

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ë–î –≤ Prisma Studio
npx prisma studio

# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
npx prisma migrate dev --name migration_name

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –≤ production
npx prisma migrate deploy

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
npm run format

# –õ–∏–Ω—Ç–∏–Ω–≥
npm run lint
\`\`\`

## üö¢ –î–µ–ø–ª–æ–π

### Docker

\`\`\`bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t smtmax-backend .

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker run -p 3000:3000 --env-file .env smtmax-backend
\`\`\`

### Production checklist

- [ ] –ò–∑–º–µ–Ω–∏—Ç—å `JWT_SECRET` –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–ª—é—á
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `CORS_ORIGIN` –Ω–∞ –¥–æ–º–µ–Ω —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å rate limiting
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

Proprietary - –û–û–û ¬´–°–ú–¢–ú–ê–ö–° –ü–†–û–î–ê–ö–®–ù¬ª

## üë• –ö–æ–Ω—Ç–∞–∫—Ç—ã

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏: support@smtmax.com
\`\`\`

---

## –®–∞–≥ 10.8: –°–æ–∑–¥–∞–Ω–∏–µ .gitignore

–°–æ–∑–¥–∞–π—Ç–µ `.gitignore`:

